# ๐ ุฏููู ุงุฎุชุจุงุฑ ูุธุงู Realtime ูู ุชุทุจูู GoDarna

## ๐ ูุงุฆูุฉ ุงูุชุญูู ุงูุดุงููุฉ

### 1. ๐ง ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช Supabase

#### ุฃ) ูุญุต ุชูุนูู Realtime ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:
```sql
-- ุชุญูู ูู ุชูุนูู Realtime ููุฌุฏุงูู ุงููุทููุจุฉ
SELECT schemaname, tablename, rowsecurity 
FROM pg_tables 
WHERE tablename IN ('profiles', 'listings', 'bookings', 'notifications', 'messages', 'favorites', 'reviews', 'payments');

-- ุชุญูู ูู publications ููู realtime
SELECT * FROM pg_publication_tables WHERE pubname = 'supabase_realtime';
```

#### ุจ) ุชุญูู ูู ุฃู ุงูุฌุฏุงูู ููุถุงูุฉ ููู Realtime:
```sql
-- ุฅุถุงูุฉ ุงูุฌุฏุงูู ููู realtime ุฅุฐุง ูู ุชูู ููุถุงูุฉ
ALTER PUBLICATION supabase_realtime ADD TABLE profiles;
ALTER PUBLICATION supabase_realtime ADD TABLE listings;
ALTER PUBLICATION supabase_realtime ADD TABLE bookings;
ALTER PUBLICATION supabase_realtime ADD TABLE notifications;
ALTER PUBLICATION supabase_realtime ADD TABLE messages;
ALTER PUBLICATION supabase_realtime ADD TABLE favorites;
ALTER PUBLICATION supabase_realtime ADD TABLE reviews;
ALTER PUBLICATION supabase_realtime ADD TABLE payments;
```

### 2. ๐ฑ ุงูุชุญูู ูู ุชุทุจูู RealtimeMixin ูู ุงูุดุงุดุงุช

#### ุงูุดุงุดุงุช ุงูุชู ูุฌุจ ุฃู ุชุญุชูู ุนูู RealtimeMixin:

โ **ุงูุดุงุดุงุช ุงูุฃุณุงุณูุฉ:**
- `home_screen.dart` - ููุฅุดุนุงุฑุงุช ูุงูุชุญุฏูุซุงุช ุงูุนุงูุฉ
- `explore_screen.dart` - ูุชุญุฏูุซุงุช ุงูุนูุงุฑุงุช
- `search_screen.dart` - ููุชุงุฆุฌ ุงูุจุญุซ ุงููุญุฏุซุฉ
- `favorites_screen.dart` - ูุชุญุฏูุซุงุช ุงูููุถูุฉ
- `bookings_screen.dart` - ูุญุงูุงุช ุงูุญุฌูุฒุงุช
- `notifications_screen.dart` - ููุฅุดุนุงุฑุงุช ุงูุฌุฏูุฏุฉ
- `profile_screen.dart` - ูุชุญุฏูุซุงุช ุงูููู ุงูุดุฎุตู

โ **ุดุงุดุงุช ุงูุชูุงุตูู:**
- `property_details_screen.dart` - ูุชุญุฏูุซุงุช ุงูุนูุงุฑ ูุงููุฑุงุฌุนุงุช
- `booking_details_screen.dart` - ูุญุงูุฉ ุงูุญุฌุฒ ูุงูุฑุณุงุฆู
- `my_bookings_screen.dart` - ูุญุฌูุฒุงุช ุงููุณุชุฃุฌุฑ
- `host_bookings_screen.dart` - ูุญุฌูุฒุงุช ุงููุถูู
- `payment_screen.dart` - ูุญุงูุฉ ุงูุฏูุน
- `payment_history_screen.dart` - ูุชุงุฑูุฎ ุงููุฏููุนุงุช

### 3. ๐งช ุงุฎุชุจุงุฑุงุช ุงููุธุงุฆู ุงูููุฑูุฉ

#### ุฃ) ุงุฎุชุจุงุฑ ุงูุฅุดุนุงุฑุงุช ุงูููุฑูุฉ:
1. **ุงูุชุญ ุงูุชุทุจูู ุนูู ุฌูุงุฒูู ูุฎุชูููู**
2. **ุณุฌู ุฏุฎูู ุจุญุณุงุจูู ูุฎุชูููู**
3. **ูู ุงูุฌูุงุฒ ุงูุฃูู:** ุฃุฑุณู ุฑุณุงูุฉ ูู ูุญุงุฏุซุฉ ุญุฌุฒ
4. **ูู ุงูุฌูุงุฒ ุงูุซุงูู:** ูุฌุจ ุฃู ุชุธูุฑ ุงูุฅุดุนุงุฑ ููุฑุงู ูู:
   - ุดุงุดุฉ ุงูุฅุดุนุงุฑุงุช
   - badge ุงูุฅุดุนุงุฑุงุช ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
   - ุดุงุดุฉ ุชูุงุตูู ุงูุญุฌุฒ (ุฅุฐุง ูุงูุช ููุชูุญุฉ)

#### ุจ) ุงุฎุชุจุงุฑ ุชุญุฏูุซุงุช ุงูุญุฌูุฒุงุช:
1. **ูู ููุญุฉ Supabase:** ุบููุฑ ุญุงูุฉ ุญุฌุฒ ูู "pending" ุฅูู "confirmed"
2. **ูู ุงูุชุทุจูู:** ูุฌุจ ุฃู ุชุชุญุฏุซ ุงูุญุงูุฉ ููุฑุงู ูู:
   - ุดุงุดุฉ ูุงุฆูุฉ ุงูุญุฌูุฒุงุช
   - ุดุงุดุฉ ุชูุงุตูู ุงูุญุฌุฒ
   - ุงูุฅุดุนุงุฑุงุช

#### ุฌ) ุงุฎุชุจุงุฑ ุงูููุถูุฉ ุงูููุฑูุฉ:
1. **ูู ุฌูุงุฒ:** ุฃุถู ุนูุงุฑ ููููุถูุฉ
2. **ูู ุฌูุงุฒ ุขุฎุฑ (ููุณ ุงูุญุณุงุจ):** ูุฌุจ ุฃู ูุธูุฑ ุงูุนูุงุฑ ูู ุงูููุถูุฉ ููุฑุงู
3. **ุงุญุฐู ูู ุงูููุถูุฉ:** ูุฌุจ ุฃู ูุฎุชูู ูู ุงูุฌูุงุฒ ุงูุขุฎุฑ ููุฑุงู

#### ุฏ) ุงุฎุชุจุงุฑ ุงูุฑุณุงุฆู ุงูููุฑูุฉ:
1. **ุงูุชุญ ูุญุงุฏุซุฉ ุญุฌุฒ ุนูู ุฌูุงุฒูู**
2. **ุฃุฑุณู ุฑุณุงูุฉ ูู ุฌูุงุฒ**
3. **ูุฌุจ ุฃู ุชุธูุฑ ููุฑุงู ูู ุงูุฌูุงุฒ ุงูุขุฎุฑ**
4. **ุชุญูู ูู ุชุญุฏูุซ "ุขุฎุฑ ุธููุฑ" ู "ููุฑุฆุช"**

### 4. ๐ ุฃุฏูุงุช ุงูุชุดุฎูุต

#### ุฃ) ูุญุต Console Logs:
```dart
// ูู RealtimeMixinุ ุชุฃูุฏ ูู ูุฌูุฏ logs:
print('๐ Realtime: Subscribed to $tableName');
print('๐จ Realtime: Received event: ${payload.eventType}');
print('โ Realtime: Error in subscription: $error');
```

#### ุจ) ูุญุต Network ูู Developer Tools:
- ุงุจุญุซ ุนู WebSocket connections ุฅูู Supabase
- ุชุฃูุฏ ูู ูุฌูุฏ ุงุชุตุงูุงุช realtime ูุดุทุฉ
- ุฑุงูุจ ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ูุงููุณุชูุจูุฉ

#### ุฌ) ูุญุต Supabase Dashboard:
1. ุงุฐูุจ ุฅูู **Database > Realtime**
2. ุชุญูู ูู ุฃู ุงูุฌุฏุงูู ูููุนูุฉ
3. ุฑุงูุจ Real-time connections ูู **Settings > API**

### 5. ๐จ ุนูุงูุงุช ุงููุดุงูู ุงูุดุงุฆุนุฉ

#### ูุดุงูู ุงูุงุชุตุงู:
- โ ูุง ุชูุฌุฏ WebSocket connections ูู Network tab
- โ ุฎุทุฃ "Failed to connect to realtime"
- โ ุงููุทุงุน ูุชูุฑุฑ ูู ุงูุงุชุตุงู

#### ูุดุงูู ุงูุตูุงุญูุงุช:
- โ ุฎุทุฃ "insufficient_privilege"
- โ ูุง ุชุตู ุงูุชุญุฏูุซุงุช ูุจุนุถ ุงููุณุชุฎุฏููู
- โ ุชุตู ุงูุชุญุฏูุซุงุช ููุณุชุฎุฏููู ุบูุฑ ูุฎูููู

#### ูุดุงูู ุงูุฃุฏุงุก:
- โ ุชุฃุฎูุฑ ูู ูุตูู ุงูุชุญุฏูุซุงุช (ุฃูุซุฑ ูู 2-3 ุซูุงูู)
- โ ุงุณุชููุงู ุนุงูู ููุฐุงูุฑุฉ
- โ ุจุทุก ูู ุงูุชุทุจูู

### 6. ๐ ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก

#### ุฃ) ุงุฎุชุจุงุฑ ุงูุญูููุฉ:
1. **ุงูุชุญ ุงูุชุทุจูู ุนูู 5+ ุฃุฌูุฒุฉ**
2. **ูู ุจุฃูุดุทุฉ ูุชุฒุงููุฉ** (ุฅุถุงูุฉ ููุถูุฉุ ุฅุฑุณุงู ุฑุณุงุฆู)
3. **ุฑุงูุจ ุณุฑุนุฉ ุงูุชุญุฏูุซุงุช**

#### ุจ) ุงุฎุชุจุงุฑ ุงูุงุณุชูุฑุงุฑ:
1. **ุงุชุฑู ุงูุชุทุจูู ููุชูุญ ููุฏุฉ ุณุงุนุฉ**
2. **ูู ุจุฃูุดุทุฉ ุฏูุฑูุฉ ูู 10 ุฏูุงุฆู**
3. **ุชุฃูุฏ ูู ุงุณุชูุฑุงุฑ ุนูู Realtime**

### 7. โ ูุนุงููุฑ ุงููุฌุงุญ

#### ุงูุฅุดุนุงุฑุงุช:
- โ ุชุตู ุงูุฅุดุนุงุฑุงุช ุฎูุงู 1-2 ุซุงููุฉ
- โ ุชุธูุฑ ูู ุฌููุน ุงูุดุงุดุงุช ุงูููุงุณุจุฉ
- โ ุชุญุฏูุซ badge ุงูุฅุดุนุงุฑุงุช ููุฑูุงู

#### ุงูุญุฌูุฒุงุช:
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูุญุฌุฒ ููุฑูุงู
- โ ุชุญุฏูุซ ููุงุฆู ุงูุญุฌูุฒุงุช
- โ ุฅุดุนุงุฑุงุช ุชุบููุฑ ุงูุญุงูุฉ

#### ุงูููุถูุฉ:
- โ ุฅุถุงูุฉ/ุญุฐู ููุฑู ุนุจุฑ ุงูุฃุฌูุฒุฉ
- โ ุชุญุฏูุซ ุงูุนุฏุงุฏุงุช
- โ ุชุญุฏูุซ ุฃููููุฉ ุงูููุจ

#### ุงูุฑุณุงุฆู:
- โ ูุตูู ุงูุฑุณุงุฆู ุฎูุงู 1 ุซุงููุฉ
- โ ุชุญุฏูุซ ุญุงูุฉ "ููุฑุฆุช"
- โ ุชุญุฏูุซ "ุขุฎุฑ ุธููุฑ"

### 8. ๐ง ุญููู ุงููุดุงูู ุงูุดุงุฆุนุฉ

#### ุฅุฐุง ูู ุชุนูู ุงูุฅุดุนุงุฑุงุช:
```sql
-- ุชุญูู ูู ุณูุงุณุงุช RLS
SELECT * FROM pg_policies WHERE tablename = 'notifications';

-- ุชุฃูุฏ ูู ูุฌูุฏ ุงูุณูุงุณุฉ ุงูุตุญูุญุฉ
DROP POLICY IF EXISTS "notifications_insert_admin" ON notifications;
CREATE POLICY "notifications_insert_authenticated" ON notifications
FOR INSERT TO authenticated
WITH CHECK (true);
```

#### ุฅุฐุง ูู ุชุนูู ุงูุฑุณุงุฆู:
```sql
-- ุชุญูู ูู ุฏุงูุฉ is_chat_participant
SELECT routine_name, routine_definition 
FROM information_schema.routines 
WHERE routine_name = 'is_chat_participant';
```

#### ุฅุฐุง ูุงู ููุงู ุจุทุก:
```dart
// ููู ุนุฏุฏ ุงูุงุดุชุฑุงูุงุช
// ุงุณุชุฎุฏู ููุงุชุฑ ุฏูููุฉ
subscribeToTable(
  'bookings',
  filter: 'tenant_id=eq.$userId',
  callback: _onBookingUpdate,
);
```

### 9. ๐ ูุฑุงูุจุฉ ูุณุชูุฑุฉ

#### KPIs ูููุฑุงูุจุฉ:
- **ุฒูู ูุตูู ุงูุฅุดุนุงุฑุงุช:** < 2 ุซุงููุฉ
- **ูุนุฏู ูุฌุงุญ ุงูุชุญุฏูุซุงุช:** > 99%
- **ุงุณุชููุงู ุงูุฐุงูุฑุฉ:** ูุณุชูุฑ
- **ุนุฏุฏ ุงูุงุชุตุงูุงุช ุงููุดุทุฉ:** ูุชููุน

#### ุฃุฏูุงุช ุงููุฑุงูุจุฉ:
- Supabase Dashboard
- Firebase Performance (ุฅุฐุง ูููุนู)
- Device logs
- User feedback

---

## ๐ฏ ุฎูุงุตุฉ ุงูุงุฎุชุจุงุฑ

ุจุนุฏ ุชุทุจูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช ุฃุนูุงูุ ูุฌุจ ุฃู ูููู ูุฏูู:

โ **ูุธุงู realtime ูุนูู ุจููุงุกุฉ 100%**
โ **ุชุญุฏูุซุงุช ููุฑูุฉ ุนุจุฑ ุฌููุน ุงูุดุงุดุงุช**
โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ููุชุฌุงูุจุฉ**
โ **ุฃุฏุงุก ูุณุชูุฑ ุชุญุช ุงูุญูููุฉ**

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงููุ ุฑุงุฌุน ุงูุญููู ุงูููุชุฑุญุฉ ุฃู ุงุทูุจ ุงููุณุงุนุฏุฉ ูุน ุชูุงุตูู ุงูุฎุทุฃ ุงููุญุฏุฏ.
